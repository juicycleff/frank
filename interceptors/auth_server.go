// Code generated by goa v3.20.0, DO NOT EDIT.
//
// auth example server interceptors
//
// Command:
// $ goa example github.com/juicycleff/frank/design -o .

package interceptors

import (
	"context"

	"goa.design/clue/log"
	goa "goa.design/goa/v3/pkg"
)

// AuthServerInterceptors implements the server interceptor for the auth service.
type AuthServerInterceptors struct {
}

// NewAuthServerInterceptors creates a new server interceptor for the auth service.
func NewAuthServerInterceptors() *AuthServerInterceptors {
	return &AuthServerInterceptors{}
}

// CSRF token interceptor
func (i *AuthServerInterceptors) CSRFToken(ctx context.Context, info *interceptors.CSRFTokenInfo, next goa.Endpoint) (any, error) {
	log.Printf(ctx, "[CSRFToken] Processing request: %v", info.RawPayload())
	resp, err := next(ctx, info.RawPayload())
	if err != nil {
		log.Printf(ctx, "[CSRFToken] Error: %v", err)
		return nil, err
	}
	log.Printf(ctx, "[CSRFToken] Response: %v", resp)
	return resp, nil
}
